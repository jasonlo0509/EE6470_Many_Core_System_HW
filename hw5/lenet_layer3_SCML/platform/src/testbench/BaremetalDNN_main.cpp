#include <iostream>
#include <cassert>
#include "runtime.h"
#include "BaremetalDNN_model.h"
#include "BaremetalDNN_Toplevel.h"
float data[1][1][6][6] = {{{{1.0230765e-06,3.9658505e-03,1.0727848e-01,1.2457452e-01,
    2.5871918e-02,4.3960853e-04},
   {8.4601872e-04,1.2639461e-01,6.4415228e-01,5.6129462e-01,
    4.8780939e-01,2.9882791e-02},
   {1.1518599e-02,4.9429536e-01,3.4860685e-01,5.6000616e-02,
    5.7373852e-01,1.2259088e-01},
   {1.6818520e-02,5.3518039e-01,1.5023892e-01,6.7439146e-02,
    6.0634851e-01,1.3390462e-01},
   {5.2749915e-03,3.6706021e-01,5.6115407e-01,5.6252080e-01,
    4.6946692e-01,3.0455662e-02},
   {1.3881053e-04,3.3321425e-02,1.2672774e-01,8.1666060e-02,
    2.1864757e-02,2.8607727e-04}}}};
float golden_out[1][4][2][2] = {{{{2.7782872 ,2.6208475 },
   {2.62353   ,2.7895133 }},

  {{0.        ,0.        },
   {0.        ,0.        }},

  {{0.64721686,0.773419  },
   {0.592239  ,0.4842242 }},

  {{0.46680248,0.9893519 },
   {1.6895875 ,1.2113988 }}}};
void BaremetalDNN_model_wraper() {
float* ret = (float*) new float[1][4][2][2];
	BaremetalDNN_toplevel(
	ret,
	(float*)data,
	(float*)net0_conv0_weight,
	(float*)net0_conv0_bias);
	compare<float>((float*)golden_out, ret, 16);
	delete[] ret;
}
